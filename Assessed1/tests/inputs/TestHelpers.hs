{-# LANGUAGE CPP #-}
{-# LANGUAGE Unsafe #-}
module TestHelpers where

import safe Assessed1Part2 (encode, encodeUsing, encodeUsingTable, makeTree,
                           generateTree, makeTable, tabulate, decode, decompress,
                           decompress', compress, compress', Tree(..), Bit(..),
                           CodingTable, Freq, Key, freq)

import Data.List

-- tests, returning Bool
test_makeTree_correctness :: () -> Bool
test_makeTree_correctness _ = decode (makeTree trees, encodeUsing_ (makeTree trees) text) == text

test_makeTree_optimality :: () -> Bool
test_makeTree_optimality _ = (length $ encodeUsing_ (makeTree trees) text) == length bits

test_generateTree_correctness :: () -> Bool 
test_generateTree_correctness _ = decode (generateTree freq_table, encodeUsing_ (generateTree freq_table) text) == text

test_generateTree_optimality :: () -> Bool
test_generateTree_optimality _ = (length $ encodeUsing_ (generateTree freq_table) text) == length bits

test_makeTable :: () -> Bool
test_makeTable _ = list_equality (makeTable tree) coding_table

test_encodeUsingTable :: () -> Bool
test_encodeUsingTable _ = encodeUsingTable coding_table text == bits

test_encodeUsing :: () -> Bool
test_encodeUsing _ = encodeUsing tree text == bits

test_encode_correctness :: () -> Bool
test_encode_correctness _ = decode (encode text) == decode (tree, bits)

test_encode_optimality :: () -> Bool
test_encode_optimality _ = (length $ snd $ encode text) == length bits

test_compress_correctness :: () -> Bool
test_compress_correctness _ = decompress (compress text) == decompress compressed_text

test_compress_optimality :: () -> Bool
test_compress_optimality _ = length (compress text) == length compressed_text

test_compress'_1 :: () -> Bool
test_compress'_1 _ = compress' "Hi there" == "*Hi there"

test_compress'_2_correctness :: () -> Bool
test_compress'_2_correctness _ = decompress' (compress' text2) == decompress' compressed_text2

test_compress'_2_optimality :: () -> Bool
test_compress'_2_optimality _ = length (compress' text2) == length compressed_text2


text = "Monads in Haskell can be thought of as composable computation descriptions. The essence of monad is thus separation of composition timeline from the composed computation's execution timeline, as well as the ability of computation to implicitly carry extra data, as pertaining to the computation itself, in addition to its one (hence the name) output, that it will produce when run (or queried, or called upon). This lends monads to supplementing pure calculations with features like I/O, common environment or state, etc. Each monad, or computation type, provides means, subject to Monad Laws, to (a) create a description of computation action that will produce (a.k.a. \"return\") a given Haskell value, (b) somehow run a computation action description (possibly getting its output back into Haskell should the monad choose to allow it, if computations described by the monad are pure, or causing the prescribed side effects if it's not), and (c) combine (a.k.a. \"bind\") a computation action description with a reaction to it – a regular Haskell function of one argument (that will receive computation-produced value) returning another action description (using or dependent on that value, if need be) – thus creating a combined computation action description that will feed the original action's output through the reaction while automatically taking care of the particulars of the computational process itself. A monad might also define additional primitives to provide access to and/or enable manipulation of data it implicitly carries, specific to its nature."
(tree, bits) = (Branch (Branch (Branch (Branch (Branch (Branch (Leaf 'g' 16) (Branch (Leaf 'y' 8) (Leaf 'k' 9) 17) 33) (Leaf 'h' 35) 68) (Leaf 'c' 68) 136) (Leaf 't' 137) 273) (Branch (Branch (Branch (Branch (Leaf ',' 17) (Branch (Leaf 'v' 9) (Leaf '(' 10) 19) 36) (Leaf 'm' 40) 76) (Branch (Branch (Branch (Leaf ')' 10) (Leaf '.' 11) 21) (Leaf 'f' 22) 43) (Leaf 'd' 44) 87) 163) (Branch (Leaf 'n' 94) (Branch (Leaf 'p' 47) (Leaf 'u' 51) 98) 192) 355) 628) (Branch (Branch (Branch (Leaf 'a' 107) (Branch (Leaf 'l' 53) (Branch (Branch (Leaf 'w' 12) (Branch (Branch (Leaf '\8211' 2) (Leaf '\'' 3) 5) (Branch (Leaf 'H' 4) (Leaf '"' 4) 8) 13) 25) (Branch (Leaf 'b' 15) (Branch (Branch (Branch (Branch (Leaf 'O' 1) (Leaf 'E' 1) 2) (Branch (Leaf 'q' 1) (Leaf 'I' 1) 2) 4) (Branch (Branch (Leaf '-' 1) (Leaf 'A' 1) 2) (Branch (Leaf 'j' 1) (Leaf 'L' 1) 2) 4) 8) (Branch (Branch (Leaf 'x' 2) (Leaf '/' 2) 4) (Branch (Leaf 'M' 2) (Leaf 'T' 2) 4) 8) 16) 31) 56) 109) 216) (Branch (Leaf 'i' 116) (Leaf 'e' 119) 235) 451) (Branch (Leaf ' ' 239) (Branch (Leaf 'o' 121) (Branch (Leaf 'r' 58) (Leaf 's' 65) 123) 244) 483) 934) 1562,[I,Z,Z,I,I,I,I,I,I,Z,I,I,I,Z,Z,I,I,Z,I,Z,Z,Z,Z,I,Z,I,I,I,I,I,I,I,I,I,Z,I,Z,I,Z,Z,I,I,Z,I,I,Z,I,Z,Z,I,I,Z,I,I,Z,I,Z,Z,Z,I,I,I,I,I,Z,Z,Z,Z,Z,I,I,I,Z,I,I,I,Z,Z,I,Z,I,Z,Z,I,Z,I,I,Z,Z,Z,Z,I,I,Z,Z,Z,Z,I,I,Z,I,I,Z,I,Z,Z,I,I,I,Z,I,Z,I,I,I,I,Z,Z,Z,I,Z,Z,Z,Z,I,I,I,I,Z,Z,I,I,I,I,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,I,Z,Z,I,I,I,Z,I,I,I,Z,Z,I,Z,I,Z,I,I,I,Z,I,Z,Z,Z,I,I,I,I,I,I,I,Z,Z,Z,Z,I,I,I,I,Z,Z,I,Z,Z,I,Z,I,I,I,Z,I,I,I,Z,I,I,I,I,I,I,Z,Z,Z,I,Z,Z,I,I,I,Z,I,Z,Z,I,Z,I,Z,I,I,I,I,Z,Z,Z,Z,I,I,I,I,Z,Z,I,Z,Z,I,Z,I,I,I,Z,Z,I,I,I,I,Z,Z,I,I,Z,Z,Z,Z,Z,I,I,Z,I,Z,I,I,I,Z,Z,I,I,Z,I,I,Z,Z,I,Z,I,I,I,Z,I,I,I,I,I,I,I,Z,Z,Z,I,I,I,I,I,Z,I,Z,I,Z,Z,I,I,I,Z,Z,Z,I,I,Z,I,Z,I,I,I,Z,Z,I,I,Z,I,I,I,I,I,Z,I,Z,I,Z,Z,I,I,I,Z,I,Z,Z,I,I,I,I,I,I,I,Z,Z,Z,Z,I,I,Z,I,I,I,I,Z,I,Z,I,I,I,I,I,I,I,I,I,I,I,I,I,Z,I,I,Z,I,I,Z,Z,Z,Z,I,I,Z,I,I,I,I,Z,I,I,I,Z,Z,I,Z,I,Z,I,I,I,Z,Z,I,Z,Z,I,I,I,I,Z,Z,I,I,Z,I,Z,Z,Z,Z,I,Z,I,I,I,I,Z,I,Z,I,Z,I,I,I,I,I,I,I,Z,Z,Z,I,Z,Z,Z,Z,I,Z,I,I,I,I,I,I,I,I,I,I,I,Z,I,I,I,I,I,I,Z,I,I,Z,I,I,I,Z,I,Z,Z,Z,I,I,I,I,Z,I,Z,Z,Z,Z,Z,I,I,Z,I,Z,I,I,I,Z,Z,I,I,Z,I,I,Z,I,I,I,Z,Z,I,Z,I,Z,I,I,I,Z,Z,Z,Z,I,I,I,I,Z,Z,I,Z,Z,I,Z,I,I,I,Z,I,I,I,Z,I,I,I,I,I,I,Z,I,Z,Z,Z,I,I,Z,I,Z,I,I,I,Z,Z,I,I,Z,I,I,Z,Z,Z,I,I,Z,I,Z,Z,I,Z,Z,I,I,Z,I,I,I,Z,Z,I,Z,I,Z,I,Z,Z,I,I,Z,I,Z,I,I,I,I,Z,Z,I,Z,I,Z,I,I,I,I,I,Z,I,I,I,Z,Z,I,Z,Z,I,I,I,Z,Z,Z,I,Z,Z,Z,Z,I,I,Z,I,I,I,I,Z,Z,Z,Z,I,I,I,I,Z,Z,I,Z,Z,I,Z,I,I,I,Z,I,I,I,Z,I,I,I,I,I,I,Z,I,I,Z,I,Z,I,I,I,I,Z,Z,Z,Z,I,I,I,I,Z,Z,I,Z,Z,I,Z,I,I,I,Z,Z,I,I,I,I,Z,Z,I,I,Z,Z,Z,Z,Z,I,I,Z,I,Z,I,I,I,Z,Z,I,I,Z,I,Z,Z,I,I,Z,I,Z,I,I,I,I,I,I,I,I,Z,I,Z,I,I,I,Z,Z,I,I,I,I,I,Z,Z,I,Z,I,I,Z,Z,Z,I,Z,I,I,I,I,Z,Z,I,I,Z,I,Z,I,I,I,Z,Z,I,I,Z,I,I,Z,Z,Z,I,I,Z,I,Z,Z,I,Z,Z,I,I,Z,I,I,I,Z,Z,I,Z,I,Z,I,Z,Z,I,I,Z,I,Z,I,I,Z,I,Z,Z,Z,Z,I,I,Z,I,Z,Z,Z,I,I,I,I,I,I,I,Z,I,Z,Z,I,I,Z,Z,I,Z,I,I,I,Z,Z,I,Z,I,Z,Z,I,Z,I,I,Z,I,Z,Z,Z,I,I,I,I,I,I,I,Z,Z,Z,I,Z,Z,Z,Z,I,I,Z,I,I,I,I,Z,I,Z,Z,Z,I,Z,Z,I,I,I,Z,I,Z,I,Z,I,Z,Z,I,Z,I,Z,I,Z,Z,Z,I,Z,Z,Z,Z,Z,I,Z,I,I,Z,I,I,I,Z,Z,I,Z,I,Z,I,I,I,Z,Z,Z,Z,I,I,I,I,Z,Z,I,Z,Z,I,Z,I,I,I,Z,Z,I,I,I,I,Z,Z,I,I,Z,Z,Z,Z,Z,I,I,Z,I,Z,I,I,I,Z,Z,I,I,Z,I,I,Z,Z,Z,I,I,I,I,Z,I,I,Z,I,Z,I,Z,Z,I,Z,Z,I,Z,I,I,I,Z,I,Z,Z,I,Z,I,Z,I,Z,Z,Z,Z,I,I,Z,I,Z,Z,Z,I,I,Z,Z,I,Z,Z,Z,Z,Z,Z,I,Z,I,I,Z,Z,Z,Z,I,I,Z,Z,Z,I,I,I,I,Z,I,I,I,I,Z,Z,Z,Z,Z,Z,I,Z,I,I,Z,I,Z,I,I,I,Z,Z,I,I,I,I,I,Z,Z,Z,Z,I,I,I,I,I,Z,I,Z,Z,Z,I,I,Z,Z,I,Z,I,I,I,Z,Z,Z,Z,Z,I,I,Z,Z,Z,Z,I,Z,Z,Z,Z,I,I,Z,I,Z,Z,Z,I,I,I,I,I,I,I,Z,Z,I,I,I,Z,I,Z,I,I,I,I,I,I,Z,Z,Z,I,I,Z,Z,Z,I,Z,I,Z,Z,I,I,Z,I,Z,I,Z,Z,I,I,Z,Z,Z,Z,Z,Z,Z,I,I,Z,Z,Z,I,I,I,I,Z,I,I,Z,Z,Z,I,Z,Z,Z,Z,I,I,Z,I,I,I,I,Z,Z,Z,Z,I,I,I,I,Z,Z,I,Z,Z,I,Z,I,I,I,Z,Z,I,I,I,I,Z,Z,I,I,Z,Z,Z,Z,Z,I,I,Z,I,Z,I,I,I,Z,Z,I,I,Z,I,I,Z,I,Z,I,Z,Z,Z,I,I,I,I,I,I,I,Z,I,I,I,Z,Z,I,Z,Z,I,Z,I,Z,I,Z,I,Z,Z,Z,Z,I,I,Z,I,Z,I,Z,Z,I,I,Z,I,I,Z,I,Z,Z,Z,Z,I,Z,I,I,Z,I,Z,I,I,I,Z,I,Z,Z,Z,I,I,Z,I,Z,I,I,I,Z,Z,I,I,Z,I,I,Z,Z,Z,I,I,I,I,Z,I,I,Z,I,Z,I,Z,Z,Z,I,I,I,I,I,I,I,I,Z,I,I,I,Z,Z,I,I,Z,I,Z,I,I,I,I,Z,Z,I,Z,Z,Z,I,I,Z,Z,Z,Z,I,I,Z,I,I,Z,I,I,Z,Z,Z,Z,I,I,Z,I,I,I,I,Z,Z,Z,I,Z,Z,Z,Z,I,I,Z,I,I,I,I,Z,Z,I,I,Z,I,Z,Z,Z,Z,I,Z,Z,I,I,Z,I,I,Z,I,Z,I,Z,Z,Z,I,I,Z,I,I,I,Z,Z,I,I,I,I,Z,Z,I,Z,I,I,I,Z,Z,I,I,I,I,Z,Z,I,Z,I,Z,Z,Z,Z,I,I,Z,Z,Z,I,Z,Z,Z,Z,I,I,Z,Z,Z,Z,Z,I,I,I,Z,I,Z,I,Z,Z,Z,I,I,I,Z,I,Z,Z,I,I,Z,Z,I,Z,I,Z,I,Z,Z,I,Z,I,Z,Z,I,Z,I,I,Z,Z,I,I,I,Z,I,I,I,I,Z,I,I,I,Z,Z,I,Z,I,I,Z,I,I,I,I,Z,Z,Z,I,I,Z,I,I,I,I,Z,I,Z,Z,I,I,Z,Z,Z,Z,Z,Z,I,I,Z,I,I,Z,I,I,Z,I,I,Z,I,I,I,I,Z,Z,I,I,I,I,Z,I,I,Z,I,I,Z,Z,I,Z,Z,Z,I,I,I,I,I,Z,I,I,I,I,Z,I,I,Z,I,Z,Z,I,I,I,I,Z,Z,I,Z,Z,I,I,I,I,I,Z,I,I,I,I,I,I,Z,I,Z,I,Z,I,Z,I,I,Z,I,Z,I,I,Z,I,Z,Z,Z,Z,I,I,Z,I,I,I,Z,I,I,I,I,Z,I,I,Z,Z,Z,Z,I,I,Z,Z,Z,I,Z,Z,I,Z,I,Z,Z,I,Z,I,Z,I,I,Z,I,Z,I,I,I,I,Z,Z,I,I,I,I,Z,I,I,I,Z,I,I,I,Z,Z,I,I,Z,Z,I,Z,I,Z,Z,Z,Z,I,Z,I,Z,Z,I,I,I,Z,I,Z,Z,I,I,I,I,I,I,I,Z,Z,Z,Z,I,I,Z,I,Z,I,I,I,I,I,I,I,Z,I,Z,Z,I,Z,I,Z,I,I,Z,I,I,Z,Z,I,Z,I,I,I,I,I,I,I,I,I,Z,Z,I,Z,Z,I,I,I,I,Z,Z,I,I,Z,I,Z,Z,Z,Z,I,Z,I,I,I,I,I,I,I,I,I,Z,Z,Z,I,I,I,I,Z,I,I,Z,I,I,I,I,I,Z,I,I,I,I,Z,I,I,I,Z,Z,I,I,I,Z,I,Z,Z,I,Z,I,Z,I,I,Z,I,Z,Z,I,I,Z,I,I,Z,I,I,Z,Z,Z,I,I,Z,I,Z,Z,I,I,Z,Z,Z,Z,Z,Z,Z,I,I,Z,Z,I,I,I,Z,Z,I,I,I,I,I,I,I,I,Z,I,Z,I,I,I,I,Z,Z,Z,Z,I,I,Z,Z,Z,I,Z,Z,I,Z,Z,Z,Z,I,Z,I,I,I,I,I,Z,Z,I,Z,I,Z,Z,Z,Z,Z,I,I,Z,I,Z,I,I,I,Z,Z,I,I,Z,I,I,I,I,I,I,I,Z,I,Z,Z,I,I,Z,Z,I,Z,I,Z,Z,Z,I,Z,Z,Z,Z,I,I,I,Z,Z,I,Z,I,Z,I,I,Z,I,I,I,Z,Z,Z,Z,Z,I,Z,I,I,I,I,I,I,I,I,Z,I,Z,I,I,I,I,I,I,I,I,I,Z,I,Z,Z,I,Z,I,Z,I,Z,Z,Z,Z,Z,Z,I,I,I,Z,I,I,I,I,Z,I,Z,Z,I,I,I,I,Z,Z,I,I,I,Z,Z,I,I,I,I,I,Z,I,I,Z,Z,I,I,I,I,Z,Z,Z,Z,Z,I,Z,Z,Z,Z,I,I,Z,Z,Z,Z,I,I,I,I,Z,Z,I,Z,Z,I,Z,I,Z,Z,I,I,I,I,Z,Z,I,I,Z,I,I,Z,I,Z,I,I,Z,I,I,Z,Z,I,Z,Z,Z,I,Z,I,Z,I,Z,I,I,I,I,Z,I,I,I,Z,Z,I,I,Z,Z,I,Z,Z,I,I,Z,I,I,Z,I,I,Z,Z,Z,I,I,I,Z,I,I,I,Z,I,I,I,I,Z,I,I,Z,I,I,I,I,I,Z,Z,I,I,Z,Z,Z,Z,Z,I,I,Z,I,I,Z,I,Z,Z,Z,Z,I,I,Z,I,Z,I,I,Z,Z,I,Z,Z,Z,I,Z,I,Z,I,Z,Z,I,I,I,Z,I,Z,Z,I,I,I,I,Z,Z,Z,I,I,Z,Z,Z,Z,Z,Z,I,Z,Z,Z,Z,I,I,I,Z,Z,I,Z,Z,I,I,I,I,Z,Z,I,I,Z,I,Z,Z,Z,Z,I,Z,I,I,Z,I,Z,Z,Z,Z,I,I,Z,I,I,I,Z,I,I,I,I,Z,I,I,Z,Z,Z,Z,I,I,I,I,Z,Z,I,Z,Z,I,Z,I,I,I,Z,Z,I,I,I,I,Z,Z,I,I,Z,Z,Z,Z,Z,I,I,Z,I,Z,I,I,I,Z,Z,I,I,Z,I,I,Z,Z,Z,I,Z,Z,Z,Z,Z,I,Z,Z,I,I,I,Z,I,Z,I,I,Z,I,Z,Z,Z,Z,I,I,Z,Z,I,I,I,Z,I,I,I,I,Z,I,I,I,Z,Z,I,Z,Z,Z,I,Z,I,Z,I,Z,Z,I,Z,I,I,I,Z,I,I,I,I,I,I,I,I,I,Z,Z,I,Z,Z,I,I,Z,I,I,I,Z,Z,Z,Z,I,I,Z,I,I,I,I,I,Z,I,Z,Z,Z,Z,I,I,Z,I,I,I,I,I,Z,I,I,I,I,I,Z,Z,I,I,I,Z,I,Z,Z,I,I,I,I,Z,I,I,Z,I,Z,I,I,Z,Z,Z,I,Z,Z,I,I,I,Z,Z,Z,I,I,I,I,Z,I,I,Z,I,Z,Z,I,I,I,I,I,I,Z,I,I,I,Z,Z,I,I,Z,I,Z,Z,Z,Z,I,Z,I,I,I,I,Z,I,Z,Z,I,I,I,I,Z,I,I,I,I,Z,Z,Z,I,Z,Z,I,I,Z,Z,I,I,I,I,I,Z,I,Z,Z,Z,Z,I,I,Z,Z,Z,I,I,I,I,Z,I,I,Z,Z,I,Z,Z,Z,I,I,I,Z,Z,Z,Z,I,Z,I,Z,Z,Z,I,I,Z,Z,Z,Z,I,I,I,I,I,Z,I,Z,I,I,I,Z,Z,Z,Z,Z,I,I,Z,I,I,I,I,Z,I,Z,Z,Z,I,I,Z,Z,I,Z,I,I,I,Z,I,I,I,I,I,I,I,Z,Z,Z,I,I,I,I,I,Z,I,Z,I,Z,Z,I,I,I,Z,Z,Z,I,I,Z,I,Z,I,I,I,Z,Z,I,I,Z,I,I,Z,I,I,I,Z,Z,I,Z,I,Z,I,I,I,Z,Z,Z,Z,I,I,I,I,Z,Z,I,Z,Z,I,Z,I,I,I,Z,Z,I,I,I,I,Z,Z,I,I,Z,Z,Z,Z,Z,I,I,Z,I,Z,I,I,I,Z,Z,I,I,Z,I,I,Z,I,Z,Z,Z,Z,Z,Z,I,Z,Z,I,I,Z,I,Z,I,I,I,Z,Z,I,I,Z,I,I,Z,Z,Z,I,Z,Z,Z,Z,I,I,Z,Z,Z,Z,Z,I,I,I,Z,I,Z,Z,I,I,Z,Z,I,Z,I,Z,I,Z,Z,I,Z,I,Z,Z,I,Z,I,I,Z,Z,I,I,I,Z,I,I,I,I,Z,I,I,I,Z,Z,I,Z,I,I,Z,I,I,I,I,Z,Z,Z,I,I,Z,I,I,I,I,Z,Z,I,Z,Z,Z,I,I,I,Z,Z,Z,Z,I,Z,I,Z,Z,I,Z,Z,Z,Z,Z,I,I,Z,I,Z,I,Z,Z,I,I,Z,Z,Z,Z,I,Z,I,Z,Z,I,I,I,Z,I,Z,Z,I,I,Z,I,I,I,I,I,I,I,Z,I,Z,I,I,Z,Z,I,Z,I,I,I,I,I,I,I,I,Z,Z,I,I,Z,I,Z,Z,I,I,Z,I,I,I,Z,I,Z,I,Z,Z,Z,I,I,Z,I,Z,Z,Z,I,I,Z,Z,Z,Z,Z,Z,Z,I,Z,I,Z,Z,I,Z,Z,Z,I,Z,I,Z,I,I,Z,I,I,Z,I,I,Z,I,Z,Z,I,I,Z,I,I,Z,I,Z,Z,Z,I,I,I,I,I,Z,Z,Z,Z,Z,I,I,I,Z,I,I,I,Z,Z,I,Z,I,Z,Z,I,Z,I,I,Z,Z,I,Z,Z,Z,I,Z,I,Z,Z,Z,I,Z,Z,I,Z,Z,I,I,I,I,I,Z,I,I,Z,I,Z,Z,Z,Z,I,I,Z,Z,I,Z,Z,Z,I,I,I,Z,Z,I,I,I,Z,Z,I,Z,I,Z,Z,Z,I,I,Z,I,I,I,I,I,I,I,I,Z,Z,I,Z,Z,I,I,Z,I,I,Z,Z,Z,Z,I,I,I,I,Z,I,Z,Z,I,I,Z,Z,I,I,Z,I,I,I,I,Z,Z,I,I,I,I,Z,I,I,Z,I,I,Z,I,Z,Z,Z,I,I,Z,Z,Z,Z,I,I,I,I,Z,Z,I,Z,Z,I,Z,I,I,I,Z,Z,I,I,I,I,Z,Z,I,I,Z,Z,Z,Z,Z,I,I,Z,I,Z,I,I,I,Z,Z,I,I,Z,I,I,Z,I,Z,Z,Z,Z,Z,Z,I,Z,Z,I,I,Z,I,Z,I,I,I,Z,Z,I,I,Z,I,I,Z,Z,I,Z,I,I,I,Z,I,I,I,I,I,I,I,Z,Z,Z,I,I,I,I,I,Z,I,Z,I,Z,Z,I,I,I,Z,Z,Z,I,I,Z,I,Z,I,I,I,Z,Z,I,I,Z,I,I,Z,Z,I,Z,Z,Z,I,I,Z,I,I,I,Z,I,I,I,Z,I,I,I,I,I,I,I,I,I,I,I,Z,I,Z,I,Z,Z,I,I,I,Z,I,Z,Z,I,Z,Z,Z,Z,Z,Z,I,Z,I,I,Z,Z,Z,Z,Z,Z,Z,I,Z,I,I,Z,Z,I,Z,Z,I,I,Z,I,Z,Z,I,I,Z,Z,Z,Z,Z,Z,Z,I,I,Z,I,Z,I,Z,Z,Z,I,I,I,I,I,I,I,I,Z,I,I,I,Z,Z,I,I,I,I,Z,Z,I,Z,I,I,I,Z,Z,I,I,I,I,Z,Z,I,I,I,Z,I,Z,Z,I,I,I,Z,I,Z,Z,Z,Z,Z,Z,I,Z,Z,Z,Z,Z,I,I,I,I,Z,I,Z,I,Z,Z,I,I,Z,Z,Z,I,I,I,I,Z,I,I,Z,I,Z,Z,I,I,Z,I,I,Z,I,Z,Z,Z,I,I,I,I,I,Z,Z,Z,Z,Z,I,I,I,Z,I,I,I,Z,Z,I,Z,I,Z,Z,I,Z,I,I,Z,I,I,I,I,I,Z,Z,Z,Z,I,I,I,I,Z,Z,I,I,I,I,I,Z,Z,I,Z,Z,I,Z,I,I,I,I,Z,Z,Z,I,Z,Z,Z,Z,I,I,Z,I,I,I,I,Z,Z,I,Z,Z,I,I,I,I,Z,Z,I,I,Z,I,Z,Z,Z,Z,I,Z,I,I,I,I,Z,Z,Z,Z,I,Z,Z,Z,Z,I,I,I,I,Z,I,I,I,Z,I,I,I,I,I,I,Z,I,I,I,I,Z,Z,Z,I,I,I,I,Z,I,I,Z,I,Z,Z,Z,I,Z,Z,I,Z,I,Z,Z,I,Z,I,I,I,Z,I,Z,Z,I,I,Z,Z,I,I,Z,I,Z,I,Z,Z,Z,I,Z,I,Z,Z,Z,Z,I,I,Z,I,Z,I,Z,Z,I,Z,I,Z,I,I,I,Z,Z,Z,Z,I,I,I,I,Z,Z,I,Z,Z,I,Z,I,I,I,Z,Z,I,I,I,I,Z,Z,I,I,Z,Z,Z,Z,Z,I,I,Z,I,Z,I,I,I,Z,Z,I,I,Z,I,I,I,I,I,I,I,Z,Z,I,Z,I,I,I,Z,I,I,I,I,I,I,I,Z,Z,Z,I,I,I,I,I,Z,I,Z,I,Z,I,Z,Z,I,I,I,Z,I,Z,I,I,Z,I,Z,I,I,I,I,Z,I,Z,Z,I,I,I,Z,Z,Z,Z,Z,Z,I,Z,I,I,Z,Z,Z,I,Z,Z,Z,Z,I,I,Z,I,I,I,I,Z,Z,I,Z,Z,I,I,I,I,Z,Z,I,I,Z,I,Z,Z,Z,Z,I,Z,I,I,I,I,Z,I,Z,Z,Z,I,I,I,I,Z,I,Z,I,I,I,I,Z,Z,I,I,I,Z,Z,I,I,I,I,I,I,I,I,Z,I,Z,I,I,Z,I,Z,Z,Z,Z,I,I,Z,I,I,I,Z,I,I,I,I,Z,I,I,Z,Z,Z,Z,I,I,Z,Z,Z,Z,I,I,I,I,I,I,I,I,I,I,Z,I,Z,Z,I,I,Z,Z,Z,Z,Z,Z,Z,I,I,Z,Z,Z,I,Z,Z,Z,Z,I,I,Z,I,I,I,I,Z,Z,I,I,I,Z,I,I,I,I,Z,I,Z,I,I,I,I,I,I,I,Z,Z,Z,I,I,I,I,I,Z,I,Z,I,Z,I,Z,Z,I,I,I,Z,I,Z,I,I,Z,I,Z,I,I,I,I,Z,I,I,I,I,I,I,Z,I,Z,Z,I,Z,I,I,I,Z,I,I,I,I,Z,I,Z,I,I,Z,I,Z,I,Z,I,Z,I,Z,I,Z,I,I,Z,I,I,Z,Z,Z,I,Z,Z,I,I,I,I,I,I,I,I,Z,I,Z,I,Z,Z,I,Z,I,Z,I,I,I,Z,I,Z,I,Z,Z,Z,I,I,Z,Z,I,I,Z,I,Z,I,I,I,I,I,I,I,I,Z,Z,I,I,Z,I,I,I,Z,Z,Z,I,Z,I,Z,I,Z,Z,Z,Z,I,Z,Z,Z,Z,I,I,Z,I,Z,Z,Z,Z,I,I,Z,Z,I,Z,I,I,I,I,Z,Z,I,Z,Z,Z,I,I,Z,Z,Z,I,Z,I,Z,I,Z,Z,Z,I,I,Z,Z,Z,Z,I,I,I,I,Z,Z,I,Z,Z,I,I,Z,Z,I,I,I,Z,I,Z,I,Z,Z,I,I,Z,I,Z,I,I,I,I,Z,Z,I,Z,Z,Z,I,I,I,Z,Z,Z,Z,I,Z,I,Z,Z,I,Z,Z,Z,Z,Z,I,I,Z,I,Z,I,Z,Z,I,I,Z,Z,Z,Z,I,Z,I,Z,Z,I,I,I,Z,I,Z,Z,I,I,Z,I,I,I,I,Z,Z,I,I,I,Z,I,Z,I,Z,Z,I,I,Z,Z,I,Z,I,I,I,Z,Z,I,I,Z,I,I,I,Z,I,Z,I,Z,Z,Z,I,I,Z,I,Z,Z,Z,I,I,Z,Z,Z,Z,I,I,I,I,Z,Z,I,Z,Z,I,Z,I,I,I,Z,Z,I,I,I,I,Z,Z,I,I,Z,Z,Z,Z,Z,I,I,Z,I,Z,I,I,I,Z,Z,I,I,Z,I,I,Z,I,Z,Z,Z,Z,Z,Z,I,Z,Z,I,I,Z,I,Z,I,I,I,Z,Z,I,I,Z,I,I,Z,Z,I,Z,I,I,I,Z,I,I,I,I,I,I,I,Z,Z,Z,I,I,I,I,I,Z,I,Z,I,Z,Z,I,I,I,Z,Z,Z,I,I,Z,I,Z,I,I,I,Z,Z,I,I,Z,I,I,Z,I,Z,Z,I,I,Z,Z,I,Z,I,Z,Z,Z,I,Z,Z,Z,Z,I,I,I,Z,I,Z,Z,Z,I,I,Z,I,I,I,I,Z,I,Z,I,I,I,Z,Z,Z,Z,Z,Z,I,Z,Z,I,I,Z,I,Z,I,I,I,Z,Z,I,I,Z,I,I,Z,Z,Z,I,I,I,I,Z,I,I,Z,I,Z,I,Z,Z,Z,I,I,I,Z,I,Z,Z,I,I,Z,I,Z,Z,I,I,Z,I,Z,Z,Z,I,I,Z,I,I,I,I,Z,I,Z,I,I,Z,Z,Z,Z,Z,Z,Z,I,I,I,I,I,Z,Z,I,Z,I,Z,Z,Z,I,I,I,I,Z,I,I,Z,I,Z,Z,I,I,Z,I,I,Z,I,Z,Z,Z,I,I,I,I,I,Z,Z,Z,Z,Z,I,I,I,Z,I,I,I,Z,Z,I,Z,I,Z,Z,I,Z,I,I,Z,Z,I,Z,I,Z,I,Z,I,I,I,I,Z,I,I,Z,Z,Z,Z,I,Z,Z,I,I,Z,I,Z,I,I,I,Z,Z,I,I,Z,I,I,Z,I,I,I,Z,Z,I,Z,I,Z,I,I,I,Z,I,I,I,Z,Z,I,I,Z,I,Z,I,I,I,I,Z,I,Z,Z,Z,I,I,I,I,Z,Z,Z,Z,Z,Z,Z,Z,I,I,I,I,Z,I,Z,Z,I,I,Z,I,I,Z,I,I,Z,Z,Z,I,I,I,Z,Z,I,Z,Z,Z,I,I,Z,Z,I,Z,Z,Z,Z,I,I,Z,Z,Z,Z,Z,I,I,I,Z,I,Z,Z,I,I,Z,Z,I,Z,I,Z,I,Z,Z,I,Z,I,Z,Z,I,Z,I,I,Z,I,I,I,I,Z,I,Z,I,I,Z,Z,Z,I,I,Z,I,I,I,Z,I,Z,Z,I,Z,Z,Z,I,Z,I,Z,I,I,I,I,Z,Z,Z,Z,I,I,I,I,Z,Z,I,Z,Z,I,Z,I,I,I,Z,Z,I,I,I,I,Z,Z,I,I,Z,Z,Z,Z,Z,I,I,Z,I,Z,I,I,I,Z,Z,I,I,Z,I,Z,Z,I,I,I,I,Z,I,Z,Z,Z,I,I,I,Z,I,I,I,I,Z,I,I,I,Z,Z,I,Z,I,I,Z,I,I,I,I,Z,Z,Z,I,I,Z,I,I,Z,I,Z,I,I,I,I,Z,Z,I,Z,Z,Z,I,Z,I,Z,Z,Z,I,Z,Z,I,Z,Z,I,I,I,I,I,Z,I,I,Z,I,Z,I,Z,Z,Z,I,I,Z,I,I,I,I,Z,I,Z,I,I,Z,Z,I,Z,I,I,I,I,I,I,I,I,Z,Z,I,I,Z,I,Z,I,Z,Z,I,I,Z,Z,Z,Z,Z,Z,Z,I,I,Z,I,Z,Z,Z,Z,I,I,Z,I,I,I,Z,Z,Z,I,Z,Z,Z,Z,I,I,Z,I,I,I,I,I,I,Z,I,I,Z,I,Z,Z,Z,Z,Z,Z,I,Z,Z,I,I,Z,I,Z,I,I,I,Z,Z,I,I,Z,I,I,Z,Z,I,Z,I,I,I,Z,I,I,I,I,I,I,I,Z,Z,Z,I,I,I,I,I,Z,I,Z,I,Z,Z,I,I,I,Z,Z,Z,I,I,Z,I,Z,I,I,I,Z,Z,I,I,Z,I,I,Z,Z,I,Z,Z,Z,I,I,Z,I,I,I,I,I,I,I,I,I,I,Z,I,Z,Z,I,I,Z,Z,Z,Z,Z,Z,Z,I,I,Z,I,I,I,Z,I,I,I,I,Z,I,I,Z,Z,I,Z,I,I,I,Z,I,I,Z,I,I,I,Z,I,Z,I,I,Z,I,I,Z,Z,I,Z,I,I,I,Z,I,I,Z,I,I,Z,Z,Z,I,I,I,Z,I,I,I,Z,Z,I,I,Z,I,I,Z,Z,Z,I,Z,Z,Z,Z,I,I,Z,Z,Z,Z,Z,I,I,I,Z,Z,I,Z,Z,Z,I,Z,I,Z,Z,Z,I,Z,Z,I,Z,Z,I,I,I,I,I,Z,I,I,Z,I,Z,Z,Z,Z,I,I,Z,I,Z,I,Z,Z,I,Z,I,Z,I,I,I,Z,Z,I,I,Z,I,Z,I,I,I,Z,I,I,Z,I,Z,I,I,I,I,Z,I,Z,Z,I,I,I,Z,I,Z,I,I,Z,I,Z,I,Z,Z,Z,I,I,Z,I,Z,Z,I,I,Z,I,Z,Z,I,I,Z,Z,Z,I,Z,Z,Z,Z,I,Z,I,I,I,I,I,I,I,I,I,I,I,Z,Z,Z,Z,I,I,I,I,I,Z,I,Z,I,I,I,Z,Z,Z,Z,Z,I,I,Z,I,Z,Z,I,I,Z,Z,Z,Z,Z,Z,Z,I,I,Z,I,Z,Z,Z,I,I,Z,Z,Z,Z,I,I,I,I,Z,Z,I,Z,Z,I,I,Z,Z,I,I,I,Z,I,Z,I,Z,Z,I,I,Z,I,Z,I,I,Z,I,Z,I,I,I,I,Z,Z,Z,Z,I,I,I,I,Z,Z,I,Z,Z,I,Z,I,I,I,Z,Z,I,I,I,I,Z,Z,I,I,Z,Z,Z,Z,Z,I,I,Z,I,Z,I,I,I,Z,Z,I,I,Z,I,I,Z,I,Z,Z,Z,Z,Z,Z,I,Z,Z,I,I,Z,I,Z,I,I,I,Z,Z,I,I,Z,I,I,Z,Z,I,Z,I,I,I,Z,I,I,I,I,I,I,I,Z,Z,Z,I,I,I,I,I,Z,I,Z,I,Z,Z,I,I,I,Z,Z,Z,I,I,Z,I,Z,I,I,I,Z,Z,I,I,Z,I,I,Z,Z,Z,I,Z,Z,Z,Z,I,I,Z,Z,Z,Z,Z,I,I,I,Z,I,Z,Z,I,I,Z,Z,I,Z,I,Z,I,Z,Z,I,Z,I,Z,Z,I,Z,I,I,Z,Z,I,Z,I,Z,I,I,Z,I,I,I,Z,I,I,Z,I,Z,I,I,I,I,Z,Z,Z,I,Z,Z,Z,Z,I,I,Z,I,I,I,I,Z,I,I,I,Z,I,I,I,I,Z,I,Z,I,Z,Z,Z,Z,Z,Z,Z,I,Z,I,Z,Z,I,I,Z,I,Z,Z,Z,I,Z,Z,I,Z,I,I,Z,I,Z,Z,Z,Z,Z,Z,I,Z,Z,I,I,Z,I,Z,I,I,I,Z,Z,I,I,Z,I,Z,Z,I,I,Z,I,Z,I,I,I,I,I,I,I,I,Z,I,I,I,Z,Z,I,I,I,I,Z,Z,I,Z,I,I,I,Z,Z,I,I,I,I,Z,Z,I,I,I,Z,Z,Z,I,Z,Z,Z,Z,I,I,I,I,I,Z,I,I,I,Z,Z,I,I,I,I,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,I,I,I,Z,Z,Z,I,Z,Z,Z,Z,I,I,Z,I,I,I,I,Z,I,I,I,I,Z,I,Z,I,I,I,Z,Z,Z,Z,Z,Z,I,Z,Z,I,I,Z,I,Z,I,I,I,Z,Z,I,I,Z,I,I,Z,I,Z,Z,I,I,Z,Z,Z,Z,Z,Z,I,I,Z,I,Z,I,Z,Z,I,Z,I,Z,I,I,I,I,Z,I,Z,Z,Z,Z,I,I,I,I,Z,Z,I,I,I,I,Z,Z,I,Z,Z,I,I,Z,Z,Z,Z,Z,I,I,Z,I,Z,Z,Z,Z,I,I,Z,Z,Z,I,Z,Z,I,Z,I,Z,Z,I,Z,Z,Z,Z,Z,Z,I,Z,I,I,Z,Z,Z,I,I,Z,Z,Z,Z,Z,Z,Z,Z,I,I,I,Z,I,Z,Z,I,I,Z,Z,Z,Z,Z,Z,Z,I,I,Z,Z,Z,Z,I,I,Z,Z,Z,I,I,I,I,Z,I,Z,I,I,I,I,Z,I,I,I,Z,Z,I,Z,I,Z,I,I,I,Z,Z,Z,I,Z,Z,Z,Z,I,I,Z,I,I,I,I,Z,Z,I,I,I,Z,I,Z,Z,Z,I,I,I,I,Z,Z,Z,I,I,Z,I,Z,Z,Z,Z,I,Z,I,I,I,I,I,Z,Z,I,Z,I,Z,Z,Z,I,I,I,I,Z,I,I,I,I,I,I,I,Z,I,I,I,Z,Z,I,Z,I,Z,I,I,I,Z,Z,Z,I,Z,Z,Z,Z,I,I,Z,I,I,I,I,Z,Z,Z,Z,I,I,I,I,Z,Z,I,Z,Z,I,Z,I,I,I,Z,Z,I,I,I,I,Z,Z,I,I,Z,Z,Z,Z,Z,I,I,Z,I,Z,I,I,I,Z,Z,I,I,Z,I,Z,Z,Z,I,Z,Z,I,Z,I,I,Z,Z,I,I,I,Z,I,I,I,I,Z,I,I,I,Z,Z,Z,Z,I,I,Z,I,I,I,I,I,I,I,I,I,I,I,I,I,I,Z,I,Z,I,Z,Z,Z,I,I,I,I,I,I,I,Z,I,I,I,Z,Z,I,Z,Z,I,Z,I,Z,I,Z,I,Z,I,Z,Z,I,I,I,Z,I,Z,Z,I,I,I,I,Z,I,Z,I,I,I,Z,Z,I,Z,Z,I,I,I,I,Z,Z,I,I,Z,I,Z,Z,Z,Z,I,Z,I,I,I,I,Z,Z,I,Z,Z,I,I,Z,I,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,Z,I,Z,Z,I,I,I,Z,I,Z,Z,Z,I,Z,Z,I,Z,I,I,I,I,I,I,I,I,Z,I,I,Z,Z,I,Z,I,I,I,Z,I,I,Z,I,Z,I,Z,I,I,Z,I,Z,Z,I,I,Z,I,Z,I,I,I,I,Z,I,Z,Z,Z,Z,I,Z,I,I,Z,I,Z,I,I,I,Z,I,Z,Z,Z,I,I,Z,I,Z,I,I,I,Z,Z,I,I,Z,I,Z,Z,Z,I,Z,Z,I,Z,I,I,Z,Z,I,I,I,Z,I,I,I,I,Z,I,Z,I,Z,Z,I,Z,Z,I,I,Z,I,Z,Z,Z,I,I,Z,I,Z,Z,I,Z,Z,Z,I,Z,I,Z,I,I,I,I,I,I,I,I,I,Z,Z,Z,I,I,I,I,Z,I,I,Z,Z,I,I,I,Z,I,I,I,I,Z,I,I,I,Z,Z,I,Z,Z,Z,I,Z,I,Z,I,Z,Z,I,Z,I,I,I,Z,I,I,I,I,Z,I,Z,Z,Z,Z,Z,Z,I,Z,Z,Z,I,I,Z,I,I,I,I,I,I,I,I,I,I,I,I,I,I,Z,Z,Z,I,I,I,I,Z,I,I,Z,I,Z,Z,Z,Z,I,I,Z,Z,I,Z,I,I,I,Z,Z,I,I,I,I,I,Z,I,I,I,I,Z,I,I,I,I,Z,I,I,Z,I,Z,I,I,Z,I,I,Z,I,Z,Z,Z,I,Z,Z,I,I,I,Z,I,Z,Z,I,Z,I,Z,I,I,I,I,Z,Z,I,Z,Z,I,I,Z,Z,Z,Z,I,I,Z,I,Z,I,Z,Z,I,I,I,Z,Z,I,I,I,I,I,Z,Z,I,Z,I,Z,Z,Z,Z,Z,I,I,Z,I,Z,I,I,I,Z,Z,I,I,Z,I,I,Z,I,I,I,Z,Z,I,Z,I,Z,I,I,I,Z,Z,I,Z,I,I,I,Z,Z,Z,Z,Z,I,I,Z,Z,Z,I,I,Z,I,Z,I,Z,Z,Z,I,I,I,Z,I,Z,I,Z,Z,I,Z,Z,I,Z,I,I,I,Z,I,Z,Z,I,Z,I,Z,I,Z,Z,Z,Z,I,I,Z,I,Z,Z,Z,I,I,Z,Z,I,Z,Z,Z,Z,Z,Z,I,Z,I,I,Z,Z,Z,Z,I,I,Z,Z,Z,I,I,I,I,Z,I,I,I,I,Z,I,Z,I,Z,I,Z,I,I,I,I,I,I,I,Z,I,Z,Z,Z,Z,I,I,Z,I,I,I,I,I,Z,I,I,I,Z,I,Z,I,I,Z,Z,Z,I,I,Z,I,Z,Z,I,Z,I,Z,I,I,Z,I,Z,Z,Z,Z,I,I,I,Z,Z,Z,I,I,I,I,Z,I,I,Z,I,Z,I,Z,Z,Z,I,I,I,I,I,I,I,I,Z,Z,I,I,Z,I,Z,Z,Z,Z,Z,I,Z,I,I,I,I,I,I,I,I,Z,I,Z,I,I,Z,I,Z,I,Z,Z,I])
freq_table = [('M',2),('o',121),('n',94),('a',107),('d',44),('s',65),(' ',239),('i',116),('H',4),('k',9),('e',119),('l',53),('c',68),('b',15),('t',137),('h',35),('u',51),('g',16),('f',22),('m',40),('p',47),('r',58),('.',11),('T',2),('\'',3),('x',2),(',',17),('w',12),('y',8),('(',10),(')',10),('q',1),('I',1),('/',2),('O',1),('v',9),('E',1),('j',1),('L',1),('"',4),('\8211',2),('-',1),('A',1)]
trees = [Leaf 'q' 1,Leaf 'I' 1,Leaf 'O' 1,Leaf 'E' 1,Leaf 'j' 1,Leaf 'L' 1,Leaf '-' 1,Leaf 'A' 1,Leaf 'M' 2,Leaf 'T' 2,Leaf 'x' 2,Leaf '/' 2,Leaf '\8211' 2,Leaf '\'' 3,Leaf 'H' 4,Leaf '"' 4,Leaf 'y' 8,Leaf 'k' 9,Leaf 'v' 9,Leaf '(' 10,Leaf ')' 10,Leaf '.' 11,Leaf 'w' 12,Leaf 'b' 15,Leaf 'g' 16,Leaf ',' 17,Leaf 'f' 22,Leaf 'h' 35,Leaf 'm' 40,Leaf 'd' 44,Leaf 'p' 47,Leaf 'u' 51,Leaf 'l' 53,Leaf 'r' 58,Leaf 's' 65,Leaf 'c' 68,Leaf 'n' 94,Leaf 'a' 107,Leaf 'i' 116,Leaf 'e' 119,Leaf 'o' 121,Leaf 't' 137,Leaf ' ' 239]
coding_table = [('g',[Z,Z,Z,Z,Z,Z]),('y',[Z,Z,Z,Z,Z,I,Z]),('k',[Z,Z,Z,Z,Z,I,I]),('h',[Z,Z,Z,Z,I]),('c',[Z,Z,Z,I]),('t',[Z,Z,I]),(',',[Z,I,Z,Z,Z,Z]),('v',[Z,I,Z,Z,Z,I,Z]),('(',[Z,I,Z,Z,Z,I,I]),('m',[Z,I,Z,Z,I]),(')',[Z,I,Z,I,Z,Z,Z]),('.',[Z,I,Z,I,Z,Z,I]),('f',[Z,I,Z,I,Z,I]),('d',[Z,I,Z,I,I]),('n',[Z,I,I,Z]),('p',[Z,I,I,I,Z]),('u',[Z,I,I,I,I]),('a',[I,Z,Z,Z]),('l',[I,Z,Z,I,Z]),('w',[I,Z,Z,I,I,Z,Z]),('\8211',[I,Z,Z,I,I,Z,I,Z,Z]),('\'',[I,Z,Z,I,I,Z,I,Z,I]),('H',[I,Z,Z,I,I,Z,I,I,Z]),('"',[I,Z,Z,I,I,Z,I,I,I]),('b',[I,Z,Z,I,I,I,Z]),('O',[I,Z,Z,I,I,I,I,Z,Z,Z,Z]),('E',[I,Z,Z,I,I,I,I,Z,Z,Z,I]),('q',[I,Z,Z,I,I,I,I,Z,Z,I,Z]),('I',[I,Z,Z,I,I,I,I,Z,Z,I,I]),('-',[I,Z,Z,I,I,I,I,Z,I,Z,Z]),('A',[I,Z,Z,I,I,I,I,Z,I,Z,I]),('j',[I,Z,Z,I,I,I,I,Z,I,I,Z]),('L',[I,Z,Z,I,I,I,I,Z,I,I,I]),('x',[I,Z,Z,I,I,I,I,I,Z,Z]),('/',[I,Z,Z,I,I,I,I,I,Z,I]),('M',[I,Z,Z,I,I,I,I,I,I,Z]),('T',[I,Z,Z,I,I,I,I,I,I,I]),('i',[I,Z,I,Z]),('e',[I,Z,I,I]),(' ',[I,I,Z]),('o',[I,I,I,Z]),('r',[I,I,I,I,Z]),('s',[I,I,I,I,I])]
compressed_text = "1099Branch (Branch (Branch (Branch (Branch (Branch (Leaf 'g' 16) (Branch (Leaf 'y' 8) (Leaf 'k' 9) 17) 33) (Leaf 'h' 35) 68) (Leaf 'c' 68) 136) (Leaf 't' 137) 273) (Branch (Branch (Branch (Branch (Leaf ',' 17) (Branch (Leaf 'v' 9) (Leaf '(' 10) 19) 36) (Leaf 'm' 40) 76) (Branch (Branch (Branch (Leaf ')' 10) (Leaf '.' 11) 21) (Leaf 'f' 22) 43) (Leaf 'd' 44) 87) 163) (Branch (Leaf 'n' 94) (Branch (Leaf 'p' 47) (Leaf 'u' 51) 98) 192) 355) 628) (Branch (Branch (Branch (Leaf 'a' 107) (Branch (Leaf 'l' 53) (Branch (Branch (Leaf 'w' 12) (Branch (Branch (Leaf '\\8211' 2) (Leaf '\\'' 3) 5) (Branch (Leaf 'H' 4) (Leaf '\"' 4) 8) 13) 25) (Branch (Leaf 'b' 15) (Branch (Branch (Branch (Branch (Leaf 'O' 1) (Leaf 'E' 1) 2) (Branch (Leaf 'q' 1) (Leaf 'I' 1) 2) 4) (Branch (Branch (Leaf '-' 1) (Leaf 'A' 1) 2) (Branch (Leaf 'j' 1) (Leaf 'L' 1) 2) 4) 8) (Branch (Branch (Leaf 'x' 2) (Leaf '/' 2) 4) (Branch (Leaf 'M' 2) (Leaf 'T' 2) 4) 8) 16) 31) 56) 109) 216) (Branch (Leaf 'i' 116) (Leaf 'e' 119) 235) 451) (Branch (Leaf ' ' 239) (Branch (Leaf 'o' 121) (Branch (Leaf 'r' 58) (Leaf 's' 65) 123) 244) 483) 934) 15621001111110111001101000010111111111010100110110100110110100011111000001110111001010010110000110000110110100111010111100010000111100111100000000001001110111001010111010001111111000011110010010111011101111110001001110100101011110000111100100101110011110011000001101011100110110010111011111110001111101010011100011010111001101111101010011101001111111000011011110101111111111111011011000011011110111001010111001001111001101000010111101010111111100010000101111111111101111110110111010001111010000011010111001101101110010101110000111100100101110111011111101000110101110011011000110100100110111001010100110101111001010111110111001001110001000011011110000111100100101110111011111101101011110000111100100101110011110011000001101011100110100110101111111101011100111110010110001011110011010111001101100011010010011011100101010011010110100001101000111111101001100101110010100101101000111111100010000110111101000100111010101001010100010000010110111001010111000011110010010111001111001100000110101110011011000111101101010010010111010010101000011010001100100000010110000110001111011110000001011010111001111100001111101000110010111000001100001000011010001111111001110101111110001100010100110101001100000001100011110110001000011011110000111100100101110011110011000001101011100110110101000111111101110010010101010000110101001101101000010110101110100011010111001101100011110110101000111111110111001101011110010001100001101101100001101111000100001101111001101000010011011010100011011100111100101110011110010100001100010000110000011101010001110100110010101001010010110011101111011100101101111000110111101001100000011011011011011110011110110110010001111101111011010011110010011111011111101010101101011010000110111011110110000110001001010010101101011110011110111011100110010100001010011101001111111000011010111111101001010110110010111111111001001111001101000010111111111000111101101111101111011100111010010101101001101101100011010011000000011001110011111111010111100001100010010000101111100101000001101011100110111111101001100101000100001110010101101110000010111111110101111111110100101010000001110111101001111001110011111011001111000001000011000011110010010100111100110110101101100100010101011110111001100100110110110001110111011110110111110011000001101101000011010110010001010100111010011110001100000010000111001001111001101000010110100001101110111101100001111001001011100111100110000011010111001101100010000010011101011010000110011101111011100100010101001011101111111110010011011100001101111101000011011111011111001110100111101101011000100111000111101101001111110111001101000010111101001111011110001001100111110100001100011110110010001110000101000110000111110101110000011011110100011001011101111111000111110101001110001101011100110110111001010111000011110010010111001111001100000110101110011011010000001001101011100110110001000011000001110100110010101001010010110011101111011100101101111000110111100100011100001010010000011010100110000101001110100110111111101011001011111111001101001101110101000110100011000000010100100010101101101101001101101000111110000011101110010100101100100010100010010011111011010000110010001110011100101000110111111110010011011000011110100110011011110011110110110100011000011110010010111001111001100000110101110011011010000001001101011100110110010111011111110001111101010011100011010111001101100100011011101110111111111110101001110100100000010110000000101100100110100110000000110101000111111110111001111001011100111100111010011101000000100000111101010011000111101101001101101000111110000011101110010100101101111100001111001111100100101111000100001101111001001111001101000010111100001000011110111011111101111000111101101000100101001011101001100110101000101000011010100101011100001111001001011100111100110000011010111001101111111001011101111111000111110101010011101011010111101001110000001011000100001101111001001111001101000010111101000111101011110011100111111110101101000011011101111011000011000011111111110100110000000110001000011011110011101111010111111100011111010101001110101101011110111111010010111011110101101010101010110110001001111111101010010101110101000110011010111111110011011100010101000010000110100001100101111001000110001010100011000011110010011001110101001101011110010001110000101001000001101010011000010100111010011011110011101010011001011100110111010100011010001100001111001001011100111100110000011010111001101101000000100110101110011011001011101111111000111110101001110001101011100110110100110010100010000111010001101111010111000000100110101110011011000111101101010001110100110100110100011011110101100000001111100101000111101101001101101000111110000011101110010100101100101010111101100001001101011100110110111001010111011100110101111010001111000000001111010011011011000111001000110010000110000011101001100101010010100101101111010110001101110100100010101111000011110010010111001111001100000110101110011010011110100011101111011100101101111000110110101111001000101000100100111110110101000110111101011001011111111001101010011000000011010000110111000100001101111110110100000010011010111001101100101110111111100011111010100111000110101110011011001000110111111111101001100000001101110111101100101110110111010110110010111011011000111011100110110001000011000001110010001010001001001111101101000011010100101011100110101110110101111010011101011010100011010011010011000100001011111111111000011111010111000001101001100000001101000110000111100100110011101010011010110101111000011110010010111001111001100000110101110011011010000001001101011100110110010111011111110001111101010011100011010111001101100010000110000011101001100101010010100101100101011011101101011110001000011011110111011110101000000010100110100010010110100000010011010111001101001101011111111011100111100101110011110011100010000111110111001111000000000011100010000110111101111010111000000100110101110011011010011000000110101001010111101000011110011110010011000001101000011000100101001000000101100011000000001110100110000000110000110001111010111101110010101110001000011011110011101000111100011010000101111100101000111101111111011100101011100010000110111100001111001001011100111100110000011010111001101000100101100111011110111000011011111111111111010100011111110111001001010101010011101001111010111001001111001101000010111100100110100000000000100111010001001011111111011001011101101010110100110101111010000101101011101000110101110011010001001011001110111101010010011010001101001000101011111111100011110110011101111011100100010101001011101111010000001000110111111111111110001111011010000110010111001111101111011110110101101101000100111010010101111001001100001101010011100111110010100000110101110011011011100101011100101110000011000110101000111010100100101110100101010000110100011001000000101100001100011110111101010101111111010000110111110111010110001101001010110100001110001111011010100011111111001101000001011111111010110101001"

text2 = "This is a long sentence with a long repeating charachter " ++ replicate 10000 '9'
compressed_text2 = "410Branch (Branch (Branch (Branch (Leaf 'n' 5) (Branch (Leaf 'g' 3) (Leaf 'c' 3) 6) 11) (Branch (Branch (Branch (Leaf 'p' 1) (Branch (Leaf 'T' 1) (Leaf 'w' 1) 2) 3) (Leaf 's' 3) 6) (Leaf 'e' 6) 12) 23) (Branch (Branch (Branch (Leaf 'r' 3) (Branch (Leaf 'l' 2) (Leaf 'o' 2) 4) 7) (Branch (Leaf 'h' 4) (Leaf 'i' 4) 8) 15) (Branch (Branch (Leaf 't' 4) (Leaf 'a' 5) 9) (Leaf ' ' 10) 19) 34) 57) (Leaf '9' 10000) 100570010010010100101100101011101011001010111011010111010010010011000000010011100101001100000110000110000000110011011100100110101101100010100111011010111010010010011000000010011101000001100100000110110101100010110000000100111000110101001101010000110100011010100110000110100001111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111"

-- helper functions
list_equality :: Eq a => [a] -> [a] -> Bool
list_equality [] [] = True
list_equality [] (y:ys) = False
list_equality (x:xs) [] = False
list_equality (x:xs) ys = (b) && (list_equality xs zs)
  where
    (b, zs) = member x ys

member :: Eq a => a -> [a] -> (Bool, [a])
member a l = aux l []
  where
    aux [] ys = (False, ys)
    aux (x:xs) ys = if a == x then (True, ys ++ xs) else aux xs (x:ys)

-- SOLUTIONS ALERT!
-- I have to include these to test makeTree and generateTree
sortWith_ :: Ord b => (a -> b) -> [a] -> [a]
sortWith_ f = sortBy (\ x y -> compare (f x) (f y))

makeTree_ :: [Tree c] -> Tree c
makeTree_ [t] = t
makeTree_ (t1:t2:ts) = makeTree_ $ sortWith_ freq tt
    where tt = (merge_ t1 t2) : ts

merge_ :: Tree c -> Tree c -> Tree c
merge_ t1 t2 = Branch t1 t2 i
    where i = freq t1 + freq t2

mapSnd :: (a -> b) -> (c,a) -> (c,b)
mapSnd f (c,a) = (c, f a)

makeTable_ :: Eq c => Tree c -> CodingTable c
makeTable_ (Leaf c _) = [(c,[])]
makeTable_ (Branch tl tr _) = (map (mapSnd (Z:)) (tl')) ++ (map (mapSnd (I:)) tr')
    where
        tl' = makeTable_ tl
        tr' = makeTable_ tr

code_ :: Eq c => CodingTable c -> c -> [Bit]
code_ [] _ = error "Found an unencoded symbol"
code_ ((s,b):table) c | c == s = b
                     | otherwise = code_ table c

encodeUsingTable_ :: Eq c => CodingTable c -> [c] -> [Bit]
encodeUsingTable_ table cs = concatMap (code_ table) cs

encodeUsing_ :: Eq c => Tree c -> [c] -> [Bit]
encodeUsing_ tree cs = encodeUsingTable_ (makeTable_ tree) cs
